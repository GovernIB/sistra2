<!DOCTYPE html>
<html lang="#{sessionBean.lang}"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:p="http://primefaces.org/ui">

<f:view locale="#{sessionBean.locale}" encoding="UTF-8" contentType="text/html">
<p:importConstants type="es.caib.sistrages.core.api.model.types.TypeImportarResultado" var="TypeImportarResultado" />

<h:head>
	<title><h:outputText value="#{msg['dialogTramiteImportar.header']}"/></title>
</h:head>

<h:body>

	<f:facet name="last">
		<h:outputStylesheet library="css" name="style.css" />
	</f:facet>

   <p:ajaxStatus id="startAjaxDialog" onstart="PF('loading').show();" oncomplete="PF('loading').hide();"/>
   <ui:include src="../common/popups.xhtml" />

	<!-- Parametros dialogo -->
	<f:metadata>
		<f:viewParam name="MODO_ACCESO" value="#{dialogTramiteImportar.modoAcceso}"/>
		<f:viewParam name="ID" value="#{dialogTramiteImportar.id}"/>
		<f:viewAction action="#{dialogTramiteImportar.init}" />
	</f:metadata>

	<h:form id="formTramite" styleClass="margin-top-10" enctype="multipart/form-data"  style="overflow-y: auto;height: 540; padding-bottom: 38px !important;">
			<h:outputScript >

			  var arrayCm = [];
					
				  window.onload=function(){
			    let contextMenu =  document.getElementsByClassName('ui-contextmenu')[0];
				onVisible(contextMenu, () => eliminarResaltar());

				document.addEventListener('contextmenu', function(ev) {
			    	ev.preventDefault();
			    	getPos();
			    	return false;
				}, false);
			  }

				function eliminarResaltar(){
					let contextMenu =  document.getElementsByClassName('ui-contextmenu')[0];
			  		let elementos = document.getElementsByClassName('resaltar');
			  		if(contextMenu!=null &amp;&amp; contextMenu.style.display=='none' &amp;&amp; elementos.length &gt; 0){
						for(let i = 0; i &lt; elementos.length; i++){
							elementos[i].classList.remove('resaltar');
						}
			  		}
				}

				function onVisible(element, callback) {
				  new IntersectionObserver((entries, observer) => {
				    entries.forEach(entry => {
				      if(entry.intersectionRatio == 0) {
				        callback(element);
				      }
				    });
				  }).observe(element);
				}

			  function getPos(){
			 	var e = window.event;

			    var posX = e.clientX;
			    var posY = e.clientY;
			    var el = document.elementFromPoint(posX, posY);

			    let elementos = document.getElementsByClassName('resaltar');
			  		if(elementos.length &gt; 0){
						for(let i = 0; i &lt; elementos.length; i++){
							elementos[i].classList.remove('resaltar');
						}
			  		}

				el.classList.add("resaltar");
				var aux = document.getElementById("formTramite:auxCopiar");
				if(el.textContent!='' &amp;&amp; el.textContent!='ui-button'){
					aux.value = el.textContent;
				}else if(el.firstChild!=null &amp;&amp; el.firstChild.value!=undefined){
					aux.value = el.firstChild.value;
				}else if(el.value!=null &amp;&amp; el.value!=''){
					aux.value = el.value;
				}else{
		          aux.value = '';
		        }

				if(aux.value!='' ){
            var multiple = false;
            var hijos = el.children;
			if((el.tagName == 'UL' || el.tagName == 'TABLE' || el.tagName == 'TR') &amp;&amp; hijos.length &gt; 1){
		            multiple = true;
		                  }else if(hijos.length &gt;= 1 ){
		                  	if(hijos.length==1  &amp;&amp; hijos[0].tagName=='DIV'){
		                  		hijos = hijos[0].children;
		                  	}
			                    for(i=0;i&lt;hijos.length;i++){
					              if(hijos[i].tagName!='SPAN' &amp;&amp; hijos[i].tagName!='LABEL'){
					                multiple=true;
					              }
			                    }

		                  }
                  var listaCm = document.getElementsByClassName('ui-contextmenu');
                  if(multiple){
                    for(i=0;i&lt;listaCm.length;i++){
                    	if(listaCm[i].style.display=='block'  &amp;&amp; !arrayCm.includes(listaCm[i])){
                    		arrayCm.push(listaCm[i]);
                    	}
	                	listaCm[i].classList.add("d-none");
					}
                  }else{
                  	for(i=0;i&lt;listaCm.length;i++){
                  		if(listaCm[i].style.display=='block'  &amp;&amp; !arrayCm.includes(listaCm[i])){
                    		arrayCm.push(listaCm[i]);
                    	}
	                	listaCm[i].classList.remove("d-none");
					}
					if(arrayCm.length&gt;1){
						arrayCm.pop();
						for(let i=0; i&lt;arrayCm.length; i++){
							arrayCm[i].style.display='none';
						}
					}
					arrayCm = [];
                  }

               }
			 }

			</h:outputScript>
			<p:growl id="growlDialogImportar" widgetVar="growlDialogImportar"	life="#{sessionBean.growlLife}" sticky="#{sessionBean.growlSticky}"  />
			<p:outputPanel id="panelUpload" styleClass="padding-right-8 padding-left-8" rendered="#{!dialogTramiteImportar.mostrarPanelInfo}">
				<p:fileUpload id="fichero" mode="advanced" fileUploadListener="#{dialogTramiteImportar.upload}" label="#{msg['botones.explorar']}" uploadLabel="#{msg['botones.anexar']}" cancelLabel="#{msg['botones.cancelar']}"
					update="formTramite growlDialogImportar panelUpload panelInfo botonImportar" fileLimit="1"  accept="application/zip" multiple="false" fileLimitMessage="#{msg['error.ficheros.limite']}"/>
			</p:outputPanel>

			<p:outputPanel id="panelInfo" rendered="#{dialogTramiteImportar.mostrarPanelInfo}" >

				<h3 style="margin-left:10px;margin-bottom:0px">#{msg['dialogTramiteImportar.headerTramiteVersion']}</h3>
				<h:panelGrid rowClasses=", ui-datatable-odd" columnClasses="imporTramitColumnaVT w10, w20, w20, w30,grid-center w10 padding-right-18, grid-left w10" columns = "6" cellpadding = "3" cellspacing = "0"  width="100%">

						<p:outputLabel value="" />
						<p:outputLabel value="#{msg['dialogTramiteImportar.headerOrigen']}"   style="font-weight: bold;" />
						<p:outputLabel value="#{msg['dialogTramiteImportar.headerDestino']}"  style="font-weight: bold;" />
						<p:outputLabel value="#{msg['dialogTramiteImportar.headerMensaje']}"  style="font-weight: bold;" />
						<p:outputLabel value="#{msg['dialogTramiteImportar.dominio.accion']}" style="font-weight: bold"  />
						<p:outputLabel value="" />


						<p:outputLabel value="#{msg['dialogTramiteImportar.headerEntidad']}:" styleClass="cabeceraImportar" />
						<p:column>
								<p:outputLabel value="#{dialogTramiteImportar.filaEntidad.dir3}" />
						</p:column>
						<p:column>
								<p:outputLabel value="#{dialogTramiteImportar.filaEntidad.dir3Actual}" />
						</p:column>
						<p:column>
							<p:outputLabel value="#{dialogTramiteImportar.filaEntidad.mensaje}"  />
						</p:column>
						<p:outputLabel value="" />
						<p:column>
							<p:tooltip for="entidadIcon" value="#{msg[dialogTramiteImportar.filaEntidad.resultado.literal]}" style="color : red; background-color : transparent;" />
							<p:outputLabel id="entidadIcon" value=""  >
									<i class="#{dialogTramiteImportar.filaEntidad.resultado.icon}" style="#{dialogTramiteImportar.filaEntidad.resultado.css}"  />
							</p:outputLabel>
						</p:column>


						<p:outputLabel value="#{msg['dialogTramiteImportar.headerArea']}:" styleClass="cabeceraImportar" rendered="#{dialogTramiteImportar.filaArea.estado != null}" />
						<p:outputLabel value="#{dialogTramiteImportar.filaArea.origenIdentificador} - #{dialogTramiteImportar.filaArea.origenDescripcion}" rendered="#{dialogTramiteImportar.filaArea.estado != null}" />
						<p:outputLabel value="#{dialogTramiteImportar.filaArea.destinoIdentificador} - #{dialogTramiteImportar.filaArea.destinoDescripcion}" rendered="#{dialogTramiteImportar.filaArea.estado != null}" />
						<p:column>
							<p:outputLabel value="#{dialogTramiteImportar.filaArea.mensaje}"  />
						</p:column>
						<p:column rendered="#{dialogTramiteImportar.filaArea.estado != null}"  >
								<p:commandButton value="..." process="@form" actionListener="#{dialogTramiteImportar.checkArea()}" style="margin-left:5px" >
									<p:ajax event="dialogReturn" listener="#{dialogTramiteImportar.returnDialogoArea}" update="areaIcon @form" />
								</p:commandButton>
						</p:column>
						<p:column>
								<p:tooltip for="areaIcon" value="#{msg[dialogTramiteImportar.filaArea.resultado.literal]}" />
								<p:outputLabel id="areaIcon" value="" rendered="#{dialogTramiteImportar.filaArea.estado != null}" >
										<i class="#{dialogTramiteImportar.filaArea.resultado.icon}" style="#{dialogTramiteImportar.filaArea.resultado.css}" />
								</p:outputLabel>
						</p:column>

						<p:outputLabel value="#{msg['dialogTramiteImportar.headerTramite']}:" styleClass="cabeceraImportar" rendered="#{dialogTramiteImportar.filaTramite.estado != null}"  />
						<p:outputLabel value="#{dialogTramiteImportar.filaTramite.origenIdentificador} - #{dialogTramiteImportar.filaTramite.origenDescripcion}" rendered="#{dialogTramiteImportar.filaTramite.estado != null}"  />
						<p:outputLabel value="#{dialogTramiteImportar.filaTramite.destinoIdentificador} - #{dialogTramiteImportar.filaTramite.destinoDescripcion}" rendered="#{dialogTramiteImportar.filaTramite.estado != null}"  />
						<p:column>
							<p:outputLabel value="#{dialogTramiteImportar.filaTramite.mensaje}"  />
						</p:column>
						<p:column rendered="#{dialogTramiteImportar.filaTramite.estado != null}"  >
								<p:commandButton value="..." rendered="#{dialogTramiteImportar.filaTramite.resultado.isWarningOrOk()}" actionListener="#{dialogTramiteImportar.checkTramite()}" style="margin-left:5px" process="@this" >
									<p:ajax event="dialogReturn" listener="#{dialogTramiteImportar.returnDialogoTramite}" update="tramiteIcon @form"/>
								</p:commandButton>
						</p:column>
						<p:column>
							<p:tooltip for="tramiteIcon" value="#{msg[dialogTramiteImportar.filaTramite.resultado.literal]}" />
							<p:outputLabel id="tramiteIcon" value="" rendered="#{dialogTramiteImportar.filaTramite.estado != null}" >
									<i class="#{dialogTramiteImportar.filaTramite.resultado.icon}" style="#{dialogTramiteImportar.filaTramite.resultado.css}" />
							</p:outputLabel>
						</p:column>

						<p:outputLabel value="#{msg['dialogTramiteImportar.headerVersion']}:" styleClass="cabeceraImportar" rendered="#{dialogTramiteImportar.filaTramiteVersion.estado != null}"  />
						<p:outputLabel value="#{dialogTramiteImportar.filaTramiteVersion.origenVersion} (release #{dialogTramiteImportar.filaTramiteVersion.origenRelease}) - #{dialogTramiteImportar.filaTramiteVersion.tramiteVersion.huella} " rendered="#{dialogTramiteImportar.filaTramiteVersion.estado != null}"   />
						<p:outputLabel value="#{dialogTramiteImportar.filaTramiteVersion.destinoVersion} (release #{dialogTramiteImportar.filaTramiteVersion.destinoRelease})" rendered="#{dialogTramiteImportar.filaTramiteVersion.estado != null}"   />
						<p:column rendered="#{dialogTramiteImportar.filaTramiteVersion.estado != null}"   >
							<p:outputLabel value=" (#{msg['dialogTramiteImportar.headerReleaseExistente']} #{dialogTramiteImportar.filaTramiteVersion.tramiteVersionActual.release}) " rendered="#{dialogTramiteImportar.filaTramiteVersion.estado.toString() == 'E' and dialogTramiteImportar.filaTramiteVersion.mensaje == null}" />
							<p:outputLabel value="#{dialogTramiteImportar.filaTramiteVersion.mensaje}"/>
						</p:column>
						<p:column rendered="#{dialogTramiteImportar.filaTramiteVersion.estado != null}"   >
								<p:commandButton value="..." rendered="#{dialogTramiteImportar.filaTramiteVersion.accion != null and dialogTramiteImportar.filaTramiteVersion.isMostrarBoton()}" actionListener="#{dialogTramiteImportar.checkTramiteVersion()}" style="margin-left:5px" process="@this" >
									<p:ajax event="dialogReturn" listener="#{dialogTramiteImportar.returnDialogoTramiteVersion}" update="tramiteVersionIcon @form"/>
								</p:commandButton>
						</p:column>
						<p:column>
							<p:tooltip for="tramiteVersionIcon" value="#{msg[dialogTramiteImportar.filaTramiteVersion.resultado.literal]}" rendered="#{dialogTramiteImportar.filaTramiteVersion.resultado != null}" />
							<p:outputLabel id="tramiteVersionIcon" value="" rendered="#{dialogTramiteImportar.filaTramiteVersion.resultado != null}"   >
									<i class="#{dialogTramiteImportar.filaTramiteVersion.resultado.icon}" style="#{dialogTramiteImportar.filaTramiteVersion.resultado.css}" />
							</p:outputLabel>
						</p:column>


						<p:outputLabel value="#{msg['dialogTramiteImportar.headerTramiteFormularioExterno']}:"  styleClass="cabeceraImportar" rendered="#{dialogTramiteImportar.mostrarFilasFormularios}" />
						<p:column rendered="#{dialogTramiteImportar.mostrarFilasFormularios}" />
						<p:column rendered="#{dialogTramiteImportar.mostrarFilasFormularios}" />
						<p:column rendered="#{dialogTramiteImportar.mostrarFilasFormularios}">
							<h:dataTable  value="#{dialogTramiteImportar.filasFormulario}" var="fila"   >
								<h:column headerClass="subTituloTablaImportarIzq">
									#{fila.mensaje}
								</h:column>
							</h:dataTable>
						</p:column>
						<p:column rendered="#{dialogTramiteImportar.mostrarFilasFormularios}" />
						<p:column rendered="#{dialogTramiteImportar.mostrarFilasFormularios}" >
							<i class="fa fa-times fa-2x" style="color:rgb(255, 19, 19)" />
						</p:column>

				</h:panelGrid>

				<p:column rendered="#{dialogTramiteImportar.filaTramiteRegistro.mostrarRegistro}">
						<p class="pTituloCabecera">
								<p:outputLabel value="#{msg['dialogTramiteImportar.headerTramiteRegistro']}" styleClass="subTituloCabecera"   />
						</p>
						<h:panelGrid columns="3" rowClasses="ui-datatable-odd, "  id="dataTableRegistro" columnClasses="padding-left-4 w80,w10 grid-right,w10 grid-center" headerClass="grid-left"  width="93%" cellspacing="0" cellpadding="5"  style="margin-left:33px;">

							<h:column>
								<p:outputLabel value=" " />
								<div style="margin-bottom:7px">
									<b><p:outputLabel value="#{msg['dialogTramiteImportar.headerVersionOficina']}: " rendered="#{dialogTramiteImportar.mostrarRegistroOficina}" /></b>
									<p:outputLabel value="#{dialogTramiteImportar.filaTramiteRegistro.oficina} - #{dialogTramiteImportar.filaTramiteRegistro.oficinaText}" rendered="#{dialogTramiteImportar.mostrarRegistroOficina}" />
								</div>
								<div style="margin-bottom:7px">
									<b><p:outputLabel value="#{msg['dialogTramiteImportar.headerVersionLibro']}: " rendered="#{dialogTramiteImportar.mostrarRegistroOficina}"  /></b>
									<p:outputLabel value="#{dialogTramiteImportar.filaTramiteRegistro.libro} - #{dialogTramiteImportar.filaTramiteRegistro.libroText}" rendered="#{dialogTramiteImportar.mostrarRegistroOficina}" />
								</div>
								<div style="margin-bottom:7px">
									<p:outputLabel value="#{dialogTramiteImportar.filaTramiteRegistro.mensaje}"  />
								</div>
							</h:column>

							<h:column>
								<p:commandButton value="..." actionListener="#{dialogTramiteImportar.checkTramiteRegistro()}" style="margin-left:5px" rendered="#{dialogTramiteImportar.isNingunError() and dialogTramiteImportar.filaTramiteRegistro.isTipoTramite()}" process="@this">
									<p:ajax event="dialogReturn" listener="#{dialogTramiteImportar.returnDialogoRegistro}" update="tramiteRegistro @form " />
								</p:commandButton>
							</h:column>

							<h:column>
								<p:tooltip for="tramiteRegistro" value="#{msg[dialogTramiteImportar.filaTramiteRegistro.resultado.literal]}" rendered="#{dialogTramiteImportar.filaTramiteRegistro.resultado != null}" />
								<p:outputLabel id="tramiteRegistro" value="" >
									<i class="#{dialogTramiteImportar.filaTramiteRegistro.resultado.icon}" style="#{dialogTramiteImportar.filaTramiteRegistro.resultado.css}" />
								</p:outputLabel>
							</h:column>
						</h:panelGrid>
				</p:column>


				<p:column rendered="#{!empty dialogTramiteImportar.filasDominios}">

					<p class="pTituloCabecera">
						<p:outputLabel value="#{msg['dialogTramiteImportar.dominios']}"  styleClass="subTituloCabecera"  />
					</p>

					<h:dataTable rowClasses=", ui-datatable-odd"  columnClasses="padding-left-4 w15, w15,w50,w10 grid-right,w10 grid-center" id="dataTablaDominios" headerClass="grid-left" value="#{dialogTramiteImportar.filasDominios}" var="fila" width="93%" cellspacing="0" cellpadding="5"  style="margin-left:33px;">

						<h:column headerClass="subTituloTablaImportarIzq">
							 <f:facet name = "header">
							 	<p:outputLabel value="#{msg['dialogTramiteImportar.dominio.identificador']}" style="font-weight: bold" />
							 </f:facet>
	      					#{fila.dominio.identificador}
						</h:column>

						<h:column headerClass="subTituloTablaImportarIzq">
							 <f:facet name = "header">
							 	<p:outputLabel value="#{msg['dialogTramiteImportar.dominio.ambito']}" style="font-weight: bold" />
							 </f:facet>
	      					#{msg['typeAmbito.' += fila.dominio.ambito]}
						</h:column>

						<h:column headerClass="subTituloTablaImportarIzq">
							<f:facet name = "header">
							 	<p:outputLabel value="#{msg['dialogTramiteImportar.headerMensaje']}" style="font-weight: bold" />
							 </f:facet>
							 <p:outputLabel  value="#{fila.mensaje}"  rendered="#{fila.visibleBoton == false}"/>
						</h:column>

						<h:column headerClass="subTituloTablaImportarDer">
							 <f:facet name = "header"><p:outputLabel value="#{msg['dialogTramiteImportar.dominio.accion']}" style="font-weight: bold" /></f:facet>
							 <p:commandButton value="..." rendered="#{fila.visibleBoton and dialogTramiteImportar.isNingunError() and dialogTramiteImportar.filaArea.accion != null}"  actionListener="#{dialogTramiteImportar.checkDominio(fila.dominio.identificador)}" style="margin-left:5px" process="@this">
	      							<p:ajax event="dialogReturn" listener="#{dialogTramiteImportar.returnDialogoDominio}" update="@form:botonImportar" />
							</p:commandButton>
						</h:column>

						<h:column headerClass="subTituloTablaImportarIzq">
							 	<f:facet name = "header"></f:facet>
							 	<p:tooltip for="iconoDominioLabel" value="#{msg[fila.resultado.literalDominio]}" />
							 	<p:outputLabel id="iconoDominioLabel" value="" >
									<i id="iconoDominio${fila.dominio.codigo}" class="#{fila.resultado.iconDominio}" style="#{fila.resultado.cssDominio}" />
								</p:outputLabel>
						</h:column>

					</h:dataTable>

					<h:panelGrid rowClasses=", ui-datatable-odd" columnClasses="padding-left-4 w15,padding-right-18" columns = "2" width="93%" style="margin-left:33px;" cellspacing="0" cellpadding="5" >

						 	<p:outputLabel value="#{msg['dialogTramiteImportar.refrescarCacheDominio']}" />
						 	<p:selectBooleanCheckbox value="#{dialogTramiteImportar.refrescarCacheDominio}" />

					</h:panelGrid>
				</p:column>


				<p:column rendered="#{!empty dialogTramiteImportar.filasFormateador}" >

					<p class="pTituloCabecera">
						<h:outputText value="#{msg['dialogTramiteImportar.formateadores']}" styleClass="subTituloCabecera"  />
					</p>
					<h:dataTable rowClasses=", ui-datatable-odd"  columnClasses="padding-left-4 w15, w15,w50,w10 grid-right,w10 grid-center" id="dataTablaFormateadores" headerClass="grid-left" value="#{dialogTramiteImportar.filasFormateador}" var="fila" width="93%" cellspacing="0" cellpadding="5"  style="margin-left:33px;">
							<h:column headerClass="subTituloTablaImportarIzq">
								 <f:facet name = "header"><p:outputLabel value="#{msg['dialogTramiteImportar.formateador.identificador']}" /></f:facet>
		      					#{fila.formateadorFormulario.identificador}
							</h:column>

							<h:column headerClass="subTituloTablaImportarIzq">
								 <f:facet name = "header"><p:outputLabel value="#{msg['dialogTramiteImportar.formateador.descripcion']}" /></f:facet>
		      					#{fila.formateadorFormulario.descripcion}
							</h:column>

							<h:column headerClass="subTituloTablaImportarIzq">
								 <f:facet name = "header" style="text-align: left;">
								 	<p:outputLabel value="#{msg['dialogTramiteImportar.headerMensaje']}" />
								 </f:facet>
		      					<p:outputLabel value=" #{fila.mensaje}"  />
							</h:column>

							<h:column headerClass="subTituloTablaImportarDer">
								 <f:facet name = "header"><p:outputLabel value="#{msg['dialogTramiteImportar.dominio.accion']}" style="font-weight: bold" /></f:facet>
								 <p:outputLabel value=" "  />
							</h:column>


							<h:column headerClass="subTituloTablaImportarIzq">
								 <f:facet name = "header"></f:facet>
								 <p:tooltip for="iconoFormateadorLabel" 	value="#{msg[fila.resultado.literal]}" />
								 <p:outputLabel id="iconoFormateadorLabel" 	value="" >
										<i id="iconoFormateador${fila.formateadorFormulario.codigo}" class="#{fila.resultado.icon}" style="#{fila.resultado.css}" />
								 </p:outputLabel>
							</h:column>

					</h:dataTable>

				</p:column>

			<p:column rendered="#{!empty dialogTramiteImportar.filasGestores}" >

					<p class="pTituloCabecera">
						<h:outputText value="#{msg['dialogTramiteImportar.gestores']}" styleClass="subTituloCabecera"  />
					</p>
					<h:dataTable rowClasses=", ui-datatable-odd"  columnClasses="padding-left-4 w15, w15,w50,w10 grid-right,w10 grid-center" id="dataTablaGestores" headerClass="grid-left" value="#{dialogTramiteImportar.filasGestores}" var="fila" width="93%" cellspacing="0" cellpadding="5"  style="margin-left:33px;">
							<h:column headerClass="subTituloTablaImportarIzq">
								 <f:facet name = "header"><p:outputLabel value="#{msg['dialogTramiteImportar.gestores.identificador']}" /></f:facet>
		      					#{fila.gestor.identificador}
							</h:column>

							<h:column headerClass="subTituloTablaImportarIzq">
								 <f:facet name = "header"><p:outputLabel value="#{msg['dialogTramiteImportar.gestores.descripcion']}" /></f:facet>
		      					#{fila.gestor.descripcion}
							</h:column>

							<h:column headerClass="subTituloTablaImportarIzq">
								 <f:facet name = "header" style="text-align: left;">
								 	<p:outputLabel value="#{msg['dialogTramiteImportar.headerMensaje']}" />
								 </f:facet>
		      					<p:outputLabel value=" #{fila.mensaje}"  />
							</h:column>

							<h:column headerClass="subTituloTablaImportarDer">
								 <f:facet name = "header"><p:outputLabel value="#{msg['dialogTramiteImportar.dominio.accion']}" style="font-weight: bold" /></f:facet>
								 <p:commandButton value="..." rendered="#{dialogTramiteImportar.isNingunError() and dialogTramiteImportar.filaArea.accion != null}" actionListener="#{dialogTramiteImportar.checkGestor(fila.gestor.identificador)}" style="margin-left:5px" process="@this">
		      							<p:ajax event="dialogReturn" listener="#{dialogTramiteImportar.returnDialogoGestor}" update="@form:botonImportar" />
								</p:commandButton>
							</h:column>

							<h:column headerClass="subTituloTablaImportarIzq">
								 <f:facet name = "header"></f:facet>
								 <p:tooltip for="iconoGestorLabel" 	value="#{msg[fila.resultado.literal]}" />
								 <p:outputLabel id="iconoGestorLabel" 	value="" >
										<i id="iconoGestor${fila.gestor.codigo}" class="#{fila.resultado.icon}" style="#{fila.resultado.css}" />
								 </p:outputLabel>
							</h:column>

					</h:dataTable>
				</p:column>


				<p:column rendered="#{!empty dialogTramiteImportar.filasSecciones}" >

					<p class="pTituloCabecera">
						<h:outputText value="#{msg['dialogTramiteImportar.secciones']}" styleClass="subTituloCabecera"  />
					</p>
					<h:dataTable rowClasses=", ui-datatable-odd"  columnClasses="padding-left-4 w15, w15,w50,w10 grid-right,w10 grid-center" id="dataTablaSecciones" headerClass="grid-left" value="#{dialogTramiteImportar.filasSecciones}" var="fila" width="93%" cellspacing="0" cellpadding="5"  style="margin-left:33px;">
							<h:column headerClass="subTituloTablaImportarIzq">
								 <f:facet name = "header"><p:outputLabel value="#{msg['dialogTramiteImportar.secciones.identificador']}" /></f:facet>
		      					#{fila.seccion.identificador}
							</h:column>

							<h:column headerClass="subTituloTablaImportarIzq">
								 <f:facet name = "header"><p:outputLabel value="#{msg['dialogTramiteImportar.secciones.descripcion']}" /></f:facet>
		      					#{fila.seccion.descripcion}
							</h:column>

							<h:column headerClass="subTituloTablaImportarIzq">
								 <f:facet name = "header" style="text-align: left;">
								 	<p:outputLabel value="#{msg['dialogTramiteImportar.headerMensaje']}" />
								 </f:facet>
		      					<p:outputLabel value=" #{fila.mensaje}"  />
							</h:column>

							<h:column headerClass="subTituloTablaImportarDer">
								 <f:facet name = "header"><p:outputLabel value="#{msg['dialogTramiteImportar.dominio.accion']}" style="font-weight: bold" /></f:facet>
							</h:column>

							<h:column headerClass="subTituloTablaImportarIzq">
								 <f:facet name = "header"></f:facet>
								 <p:tooltip for="iconoGestorLabel" 	value="#{msg[fila.resultado.literal]}" />
								 <p:outputLabel id="iconoGestorLabel" 	value="" >
										<i id="iconoGestor${fila.seccion.codigo}" class="#{fila.resultado.icon}" style="#{fila.resultado.css}" />
								 </p:outputLabel>
							</h:column>

					</h:dataTable>
				</p:column>


				<br />
				<br />
				<br />

				<p:column >
					<p:outputLabel value="INFO:" style="display:none" />
					<p:outputLabel value="Revision: #{dialogTramiteImportar.revisionZip}" style="display:none" />
					<p:outputLabel value="Modo: #{dialogTramiteImportar.modoZip}" style="display:none" />
					<p:outputLabel value="dir3zip: #{dialogTramiteImportar.dir3zip}" style="display:none" />
					<p:outputLabel value="Fecha: #{dialogTramiteImportar.fechaZip}" style="display:none" />
					<p:outputLabel value="Usuario: #{dialogTramiteImportar.usuarioZip}" style="display:none" />
					<p:outputLabel value="Version: #{dialogTramiteImportar.versionZip}" style="display:none" />
				</p:column>



			</p:outputPanel>

		  	 <p:outputPanel styleClass="botonera">
		     	<p:toolbar>
					<f:facet name="right">
		        		<p:commandButton id="botonImportar" widgetVar="botonImportarWidget" onclick="disableClick()"  oncomplete="enableClick()" value="#{msg['botones.importar']}" actionListener="#{dialogTramiteImportar.importar}" process="@this" styleClass="boton-azul" update="@form growlDialogImportar" disabled="#{!dialogTramiteImportar.isTodoCorrecto()}"  />
		        		<p:commandButton value="#{msg['botones.cerrar']}" actionListener="#{dialogTramiteImportar.cancelar}" process="@this" />
		        		<p:commandButton id="btnHelp" value="#{msg['botones.ayuda']}" icon="fa fa-question-circle-o" actionListener="#{dialogTramiteImportar.ayuda()}" process="@this"/>
					</f:facet>
				</p:toolbar>
		    </p:outputPanel>

 			<h:outputScript >

				function getWidgetVarById(id) {
				   for (var propertyName in PrimeFaces.widgets) {
				     if (PrimeFaces.widgets[propertyName].id === id) {
				       return PrimeFaces.widgets[propertyName];
				     }
				   }
				}

				function disableClick(){
					var elemento = getWidgetVarById('formTramite:botonImportar');
					elemento.disable();
				}

				function enableClick(){
					var elemento = getWidgetVarById('formTramite:botonImportar');
					elemento.enable();
				}

		</h:outputScript>
		<p:contextMenu>
     	<p:menuitem value="#{msg['botones.copiar']}" icon="fa fa-clipboard" styleClass="w90" id="mnuCopy"  process="@this :formTramite:auxCopiar" update=":formTramite:growlDialogImportar" />
	    </p:contextMenu>
	    <pe:clipboard id="clipContextCopy" trigger="mnuCopy" action="copy" target="auxCopiar">
			<p:ajax event="success" listener="#{dialogTramiteImportar.copiadoCorr}" process="@this" update="@this :formTramite:growlDialogImportar"/>
	        <p:ajax event="error" listener="#{dialogTramiteImportar.copiadoErr}" update="@this :formTramite:growlDialogImportar"/>
	    </pe:clipboard>

	    <p:inputText id="auxCopiar" value="#{dialogTramiteImportar.portapapeles}" style="padding:0px; opacity:0; width: 1px; height:1px; cursor:default;"/>
	</h:form>
	<p:confirmDialog widgetVar="avisoDlg" header="#{msg['warning.titulo']}" message="#{msg['variable.area.asociada.tramite']}">
		<p:outputPanel styleClass="confirmar_botonera">
			<p:commandButton value="#{msg['botones.aceptar']}" type="button" onclick="PF('avisoDlg').hide();" process="@this"/>
		</p:outputPanel>
	</p:confirmDialog>
</h:body>

</f:view>
</html>