<!DOCTYPE html>
<html lang="#{sessionBean.lang}"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	>

<f:view locale="#{sessionBean.locale}" encoding="UTF-8" contentType="text/html">

<h:head>
	<title><h:outputText value="#{msg['dialogInformacionPagos.titulo']}"/></title>
</h:head>
<h:body>
  	<f:facet name="last">
    	<h:outputStylesheet library="css" name="style.css" />
  	</f:facet>

	<!-- Parametros dialogo -->
	<f:metadata>
		<f:viewParam name="MODO_ACCESO" value="#{dialogInformacionPagos.modoAcceso}"/>
		<f:viewAction action="#{dialogInformacionPagos.init}" />
	</f:metadata>
	<h:form id="dialogInformacionPagos" styleClass="margin-top-10">
			<h:outputScript>
				 window.onload=function(){
			    let contextMenu =  document.getElementsByClassName('ui-contextmenu')[0];
				onVisible(contextMenu, () => eliminarResaltar());

				document.addEventListener('contextmenu', function(ev) {
			    	ev.preventDefault();
			    	getPos();
			    	return false;
				}, false);
			  }

				function eliminarResaltar(){
					let contextMenu =  document.getElementsByClassName('ui-contextmenu')[0];
			  		let elementos = document.getElementsByClassName('resaltar');
			  		if(contextMenu!=null &amp;&amp; contextMenu.style.display=='none' &amp;&amp; elementos.length &gt; 0){
						for(let i = 0; i &lt; elementos.length; i++){
							elementos[i].classList.remove('resaltar');
						}
			  		}
				}

				function onVisible(element, callback) {
				  new IntersectionObserver((entries, observer) => {
				    entries.forEach(entry => {
				      if(entry.intersectionRatio == 0) {
				        callback(element);
				      }
				    });
				  }).observe(element);
				}

			  function getPos(){
			 	var e = window.event;

			    var posX = e.clientX;
			    var posY = e.clientY;
			    var el = document.elementFromPoint(posX, posY);

			    let elementos = document.getElementsByClassName('resaltar');
			  		if(elementos.length &gt; 0){
						for(let i = 0; i &lt; elementos.length; i++){
							elementos[i].classList.remove('resaltar');
						}
			  		}

				el.classList.add("resaltar");
				var aux = document.getElementById("dialogInformacionPagos:auxCopiar");
				if(el.textContent!='' &amp;&amp; el.textContent!='ui-button'){
					aux.value = el.textContent;
				}else if(el.firstChild!=null &amp;&amp; el.firstChild.value!=undefined){
					aux.value = el.firstChild.value;
				}else if(el.value!=null &amp;&amp; el.value!=''){
					aux.value = el.value;
				}else{
		          aux.value = '';
		        }

				var dataT = document.getElementsByClassName('ui-datatable-scrollable-body')[0];
				var elEnDataT = dataT.getElementsByClassName('resaltar')[0];
				if(elEnDataT!=null){
					document.getElementById("dialogInformacionPagos:detalle").classList.remove("d-none");
					document.getElementById("dialogInformacionPagos:detalle").classList.add("d-block");
				}else{
					document.getElementById("dialogInformacionPagos:detalle").classList.remove("d-block");
					document.getElementById("dialogInformacionPagos:detalle").classList.add("d-none");
				}
			 }
			</h:outputScript>
				<p:contextMenu>
       			<p:menuitem value="#{msg['botones.copiar']}" icon="fa fa-clipboard" styleClass="w90" id="mnuCopy"  process="@this :dialogInformacionPagos:auxCopiar" update="growl" />
       			<p:separator/>
       			<p:menuitem id="detalle" icon="fa fa-window-maximize" onclick="consultar();" value="#{msg['dialogAuditoriaTramites.descripcion']}"  process="@this" update="growl"/>
		    </p:contextMenu>
		    <pe:clipboard id="clipContextCopy" trigger="mnuCopy" action="copy" target="auxCopiar">
				<p:ajax event="success" listener="#{dialogInformacionPagos.copiadoCorr}" process="@this" update="@this growl"/>
            	<p:ajax event="error" listener="#{dialogInformacionPagos.copiadoErr}" update="@this growl"/>
        	</pe:clipboard>

		    <p:inputText id="auxCopiar" value="#{dialogInformacionPagos.portapapeles}" style="padding:0px; opacity:0; width: 1px; height:1px; cursor:default;"/>

			<p:outputPanel>
				<p:growl id="growl" widgetVar="growl" showDetail="false" life="2000" sticky="false" />
				<p:fieldset legend="#{msg['dialogInformacionPagos.informacionGeneral']}" styleClass="margin-left-10 margin-right-10 noPadding">
			 		<h:panelGrid rowClasses=",ui-datatable-odd" columnClasses="padding-left-8 w25 grid-right,padding-right-18 w30,padding-left-8 w20 grid-right,padding-right-18 w25" columns="4" styleClass="w100">
				 		<p:outputLabel for="identificadorPago" value="#{msg['dialogInformacionPagos.identificadorPago']}:" />
						<p:inputText id="identificadorPago" value="#{dialogInformacionPagos.datosSesionPago.identificadorPago}" disabled="true" size="35"/>

				 		<p:outputLabel for="pasarelaId" value="#{msg['dialogInformacionPagos.pasarelaId']}:" />
						<p:inputText id="pasarelaId" value="#{dialogInformacionPagos.datosSesionPago.pasarelaId}" disabled="true" size="35"/>

				 		<p:outputLabel for="entidadId" value="#{msg['dialogInformacionPagos.entidadId']}:" />
						<p:inputText id="entidadId" value="#{dialogInformacionPagos.datosSesionPago.entidadId}" disabled="true" size="35"/>

				 		<p:outputLabel for="organismoId" value="#{msg['dialogInformacionPagos.organismoId']}:" />
						<p:inputText id="organismoId" value="#{dialogInformacionPagos.datosSesionPago.organismoId}" disabled="true" size="35"/>

				 		<p:outputLabel for="presentacion" value="#{msg['dialogInformacionPagos.presentacion']}:" />
						<p:inputText id="presentacion" value="#{msg['typePresentacion.'.concat(dialogInformacionPagos.datosSesionPago.presentacion)]}" disabled="true" size="35"/>

				 		<p:outputLabel for="simulado" value="#{msg['dialogInformacionPagos.simulado']}:" />
						<p:inputText id="simulado" value="#{dialogInformacionPagos.datosSesionPago.simulado?'Si':'No'}" disabled="true" size="35"/>

				 		<p:outputLabel for="sujetoPasivoNif" value="#{msg['dialogInformacionPagos.nif']}:" />
						<p:inputText id="sujetoPasivoNif" value="#{dialogInformacionPagos.datosSesionPago.sujetoPasivo.nif}" disabled="true" size="35"/>

				 		<p:outputLabel for="sujetoPasivoNombre" value="#{msg['dialogInformacionPagos.nombre']}:" />
						<p:inputText id="sujetoPasivoNombre" value="#{dialogInformacionPagos.datosSesionPago.sujetoPasivo.nombre}" disabled="true" size="35"/>

				 		<p:outputLabel for="modelo" value="#{msg['dialogInformacionPagos.modelo']}:" />
						<p:inputText id="modelo" value="#{dialogInformacionPagos.datosSesionPago.modelo}" disabled="true" size="35"/>

				 		<p:outputLabel for="concepto" value="#{msg['dialogInformacionPagos.concepto']}:" />
						<p:inputText id="concepto" value="#{dialogInformacionPagos.datosSesionPago.concepto}" disabled="true" size="35"/>

				 		<p:outputLabel for="tasaId" value="#{msg['dialogInformacionPagos.tasaId']}:" />
						<p:inputText id="tasaId" value="#{dialogInformacionPagos.datosSesionPago.tasaId}" disabled="true" size="35"/>

				 		<p:outputLabel for="importe" value="#{msg['dialogInformacionPagos.importe']}:" />
						<p:inputText id="importe" value="#{dialogInformacionPagos.datosSesionPago.importe/100}" disabled="true" size="35"/>

				 		<p:outputLabel for="fechaPago" value="#{msg['dialogInformacionPagos.fechaPago']}:" />
				 		<p:calendar id="fechaPago" value="#{dialogInformacionPagos.dato.fechaPago}" size="15" locale="#{sessionBean.locale}" pattern="dd/MM/yyyy HH:mm:ss" showButtonPanel="false" disabled="true"/>

				 		<p:outputLabel for="localizador" value="#{msg['dialogInformacionPagos.localizador']}:" />
						<p:inputText id="localizador" value="#{dialogInformacionPagos.datosSesionPago.localizador}" disabled="true" size="35"/>
					</h:panelGrid>
				</p:fieldset>
				<p:spacer height="5px"/>
				<p:fieldset legend="#{msg['dialogInformacionPagos.detalle']}" styleClass="margin-left-10 margin-right-10  noPadding" rendered="#{dialogInformacionPagos.mostrarDetalle}">
			 		<h:panelGrid rowClasses=", ui-datatable-odd" columnClasses="padding-left-18 w25 grid-right,padding-right-18 w75" columns="2"  styleClass="w100">
				 		<p:outputLabel for="verificado" value="#{msg['dialogInformacionPagos.verificado']}:" />
						<p:inputText id="verificado" value="#{dialogInformacionPagos.verificacion.verificado?'Si':'No'}" disabled="true" size="35"/>

						<p:outputLabel for="pagado" value="#{msg['dialogInformacionPagos.pagado']}:" />
						<p:inputText id="pagado" value="#{dialogInformacionPagos.verificacion.pagado?'Si':'No'}" disabled="true" size="35"/>

						<p:outputLabel for="codigoError" value="#{msg['dialogInformacionPagos.codigoError']}:" />
						<p:inputText id="codigoError" value="#{dialogInformacionPagos.verificacion.codigoError}" disabled="true" size="35"/>

						<p:outputLabel for="mensajeError" value="#{msg['dialogInformacionPagos.mensajeError']}:" />
						<p:inputText id="mensajeError" value="#{dialogInformacionPagos.verificacion.mensajeError}" disabled="true" size="35"/>
					</h:panelGrid>

				</p:fieldset>
			</p:outputPanel>

		  	 <p:outputPanel styleClass="botonera">
		     	<p:toolbar>
					<f:facet name="right">
					<p:commandButton id="btnHelp" value="#{msg['botones.ayuda']}" icon="fa fa-question-circle-o" process="@this" actionListener="#{dialogInformacionPagos.ayuda}"/>
					<p:commandButton value="#{msg['botones.volver']}" actionListener="#{dialogInformacionPagos.cerrar}" process="@this" styleClass="boton-azul"/>
					</f:facet>
				</p:toolbar>
		    </p:outputPanel>
	</h:form>
</h:body>

</f:view>
</html>
