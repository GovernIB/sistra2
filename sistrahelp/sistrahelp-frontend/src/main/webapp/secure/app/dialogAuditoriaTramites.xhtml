<!DOCTYPE html>
<html lang="#{sessionBean.lang}"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

<f:view locale="#{sessionBean.locale}" encoding="UTF-8" contentType="text/html">

<h:head>
	<title><h:outputText value="#{msg['dialogAuditoriaTramites.titulo']}"/></title>
</h:head>
<h:body>
  	<f:facet name="last">
    	<h:outputStylesheet library="css" name="style.css" />
  	</f:facet>

	<!-- Parametros dialogo -->
	<f:metadata>
		<f:viewParam name="MODO_ACCESO" value="#{dialogAuditoriaTramites.modoAcceso}"/>
		<f:viewAction action="#{dialogAuditoriaTramites.init}" />
	</f:metadata>
	<h:form id="dialogAuditoriaTramites" styleClass="margin-top-10">
  			<p:outputPanel>
				<!-- Contenido dialogo -->
				<!-- Growl mensajes -->
				<p:growl id="growlDialog" widgetVar="growlDialog" life="2000" sticky="false" />

				<p:fieldset legend="#{msg['dialogAuditoriaTramites.informacionGeneral']}" styleClass="margin-left-10 margin-right-10  noPadding" rendered="#{dialogAuditoriaTramites.dato.idSesionTramitacion ne null}">
			 		<h:panelGrid rowClasses=",ui-datatable-odd" columnClasses="padding-left-18 w25 grid-right,padding-right-18 w75" columns="2" styleClass="w100">
				 		<p:outputLabel for="evento" value="#{msg['dialogAuditoriaTramites.nombreEvento']}:" />
						<p:inputText id="evento" value="#{dialogAuditoriaTramites.dato.tipoEvento}" disabled="true" size="100"/>

				 		<p:outputLabel for="nomTramite" value="#{msg['dialogAuditoriaTramites.nomTramite']}:" />
						<p:inputText id="nomTramite" value="#{dialogAuditoriaTramites.dato.descripcionTramite}" disabled="true" size="100"/>

						<p:outputLabel for="idTramite" value="#{msg['dialogAuditoriaTramites.idTramite']}:" />
						<p:inputText id="idTramite" value="#{dialogAuditoriaTramites.dato.idTramite}" disabled="true" size="100"/>

				 		<p:outputLabel for="idProcedimientoCP" value="#{msg['dialogAuditoriaTramites.idProcedimiento']}:" />
						<p:inputText id="idProcedimientoCP" value="#{dialogAuditoriaTramites.dato.idProcedimientoCP}" disabled="true" size="100"/>

				 		<p:outputLabel for="idProcedimientoSIA" value="#{msg['dialogAuditoriaTramites.sia']}:" />
						<p:inputText id="idProcedimientoSIA" value="#{dialogAuditoriaTramites.dato.idProcedimientoSIA}" disabled="true" size="100"/>

				 		<p:outputLabel for="idSesionTramitacion" value="#{msg['dialogAuditoriaTramites.idSesion']}:" />
						<p:inputText id="idSesionTramitacion" value="#{dialogAuditoriaTramites.dato.idSesionTramitacion}" disabled="true" size="100"/>

				 		<p:outputLabel for="fecha" value="#{msg['dialogAuditoriaTramites.fecha']}:" />
				 		<p:calendar id="fecha" value="#{dialogAuditoriaTramites.dato.fecha}" size="100" locale="#{sessionBean.locale}" pattern="dd/MM/yyyy HH:mm:ss" showButtonPanel="false" disabled="true"/>

						<p:outputLabel for="nombreUsu" value="#{msg['dialogAuditoriaTramites.nombreUsu']}:" />
						<p:inputText id="nombreUsu" value="#{dialogAuditoriaTramites.dato.nombre.concat(' ').concat(dialogAuditoriaTramites.dato.apellido1).concat(' ').concat(dialogAuditoriaTramites.dato.apellido2)}" disabled="true" size="100"/>

						<p:outputLabel for="nifUsu" value="#{msg['dialogAuditoriaTramites.nifUsu']}:" />
						<p:inputText id="nifUsu" value="#{dialogAuditoriaTramites.dato.nif}" disabled="true" size="100"/>

				 		<p:outputLabel for="descripcion" value="#{msg['dialogAuditoriaTramites.descripcion']}:" />
						<p:inputTextarea id="descripcion" value="#{dialogAuditoriaTramites.dato.descripcion}" disabled="true" rows="3" cols="100"/>

				 		<p:outputLabel for="resultado" value="#{msg['dialogAuditoriaTramites.resultado']}:" />
						<p:inputText id="resultado" value="#{dialogAuditoriaTramites.dato.resultado}" disabled="true" size="100"/>
					</h:panelGrid>
				</p:fieldset>
				<p:spacer height="5px"/>
				<p:fieldset legend="#{msg['dialogAuditoriaTramites.detalle']}" styleClass="margin-left-10 margin-right-10  noPadding"  rendered="#{dialogAuditoriaTramites.mostrarDetalle}">
			 		<h:panelGrid rowClasses=",ui-datatable-odd" columnClasses="padding-left-18 w18 grid-right,padding-right-18 w75, w5" columns="3" styleClass="w100">
				 	 	<p:outputLabel for="codigoError" value="#{msg['dialogAuditoriaTramites.codigoError']}:" rendered="#{dialogAuditoriaTramites.dato.codigoError != null and not empty dialogAuditoriaTramites.dato.codigoError}" />
				 		<h:panelGroup rendered="#{dialogAuditoriaTramites.dato.codigoError != null and not empty dialogAuditoriaTramites.dato.codigoError}" >
							<p:inputText id="codigoError" value="#{dialogAuditoriaTramites.dato.codigoError}" disabled="true" size="70"/>
							<p:spacer width="5px"/>
							<p:commandButton value="#{msg['dialogAuditoriaTramites.trazaError']}" id="trazaErrorBtn" onclick="PF('dlgTraza').show();" rendered="#{dialogAuditoriaTramites.dato.trazaError ne null}" process="@this"/>

							<p:dialog header="#{msg['dialogAuditoriaTramites.tituloTraza']}" widgetVar="dlgTraza"  modal="true" resizable="true" height="605" width="900">
								<p:outputPanel styleClass="w100 h100">
							    	<p:inputTextarea value="#{dialogAuditoriaTramites.dato.trazaError}" rows="33" cols="120"  autoResize="true" readonly="true" styleClass="w100 h90"/>
							    	<p:spacer height="5px"/>
									<p:outputPanel styleClass="confirmar_botonera w100">
										<p:toolbar>
											<f:facet name="right">
												<p:commandButton value="#{msg['botones.volver']}" onclick="PF('dlgTraza').hide();" process="@this"/>
											</f:facet>
										</p:toolbar>
									</p:outputPanel>
								</p:outputPanel>
							</p:dialog>
						</h:panelGroup>
						<p:column rendered="#{dialogAuditoriaTramites.dato.codigoError != null and not empty dialogAuditoriaTramites.dato.codigoError}"> </p:column>

						<p:outputLabel for="dataTablePropiedades" value="#{msg['dialogAuditoriaTramites.headerPropiedades']}:" />
						<p:column>
							<p:dataTable  id="dataTablePropiedades" var="td" value="#{dialogAuditoriaTramites.dato.propiedadesEvento.asArrayList}"
										  emptyMessage="#{msg['error.emptyRows']}"
										  scrollable="true"
				                          paginator="false"
				                          selection="#{dialogAuditoriaTramites.valorSeleccionado}"
								          selectionMode="single" rowKey="#{td.key}"
				                          >

								<p:ajax event="rowSelect" global="false" update="dialogAuditoriaTramites:txtCopy" />

								<!-- Columnas -->
							    <p:column headerText="#{msg['dialogAuditoriaTramites.headerPropiedades.codigo']}" style="width:30%;"  class="ui-panelgrid-cell">
							        <h:outputText value="#{td.key}" />
							    </p:column>

							    <p:column headerText="#{msg['dialogAuditoriaTramites.headerPropiedades.valor']}" style="width:70%;" class="ui-panelgrid-cell">
							        <h:outputText value="#{td.value}" />
							    </p:column>

				 			</p:dataTable>

			 			</p:column>
			 			<p:column for="dataTablePropiedades" value="#{msg['dialogAuditoriaTramites.headerPropiedades']}:">
			 				<p:inputText id="txtCopy" value="#{dialogAuditoriaTramites.copiar}" style="display:none" />
							<p:commandButton id="btnCopiar" value=" " icon="fa fa-copy" onclick="copiarClipboard();" style="height:20px;width:30px" process="@this"/>
							<p:commandButton id="hiddenCommandGrowl" styleClass="button" process="@this" update="growlDialog"  action="#{dialogAuditoriaTramites.avisarGrowl()}"  style="display:none" />
						</p:column>


						<p:spacer height="10px"/>
						<p:spacer height="10px"/>
						<p:spacer height="10px"/>
					</h:panelGrid>
					 <h:outputScript >

							function copiarClipboard() {

								// Crea un campo de texto "oculto"
								var aux = document.createElement("input");

								var texto = document.getElementById("dialogAuditoriaTramites:txtCopy");

								// Asigna el contenido del elemento especificado al valor del campo
								aux.setAttribute("value", texto.value);

								// Añade el campo a la página
								document.body.appendChild(aux);

								// Selecciona el contenido del campo
								aux.select();

								// Copia el texto seleccionado
								document.execCommand("copy");

								// Elimina el campo de la página
								document.body.removeChild(aux);

								document.getElementById("dialogAuditoriaTramites:hiddenCommandGrowl").click();
							}


						</h:outputScript>

				</p:fieldset>
			</p:outputPanel>
		  	 <p:outputPanel styleClass="botonera">
		     	<p:toolbar>
					<f:facet name="right">
						<p:commandButton id="btnHelp" value="#{msg['botones.ayuda']}" icon="fa fa-question-circle-o" process="@this" actionListener="#{dialogAuditoriaTramites.ayuda()}" />
						<p:commandButton value="#{msg['botones.volver']}" actionListener="#{dialogAuditoriaTramites.cerrar}" process="@this" styleClass="boton-azul" />
					</f:facet>
				</p:toolbar>
		    </p:outputPanel>
	</h:form>
</h:body>

</f:view>
</html>
